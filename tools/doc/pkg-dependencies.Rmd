
```{r include = FALSE}
options(
  pkg.show_progress = FALSE,
  cli.unicode = FALSE)
knitr::opts_chunk$set(
  cache = TRUE,
  class.source = "r copy")
```

The usual steps to query package dependencies are:

1. Create a `pkg_deps` object with `new_pkg_deps()`.
1. Resolve all possible dependencies with
   [`pkg_deps$resolve()`](#method-resolve).
1. Solve the dependencies, to obtain a subset of all possible
   dependencies that can be installed together, with
   [`pkg_deps$solve()`](#method-solve).
1. Call [`pkg_deps$get_solution()`](#method-get-solution) to list the
   result of the dependency solver.

Methods
==========================================================================

Public methods
-------------------------------------

* [`pkg_deps$new()`](#method-new)
* [`pkg_deps$get_refs()`](#method-get-refs)
* [`pkg_deps$get_config()`](#method-get-config)
* [`pkg_deps$resolve()`](#method-resolve)
* [`pkg_deps$async_resolve()`](#method-async-resolve)
* [`pkg_deps$get_resolution()`](#method-get-resolution)
* [`pkg_deps$solve()`](#method-solve)
* [`pkg_deps$get_solution()`](#method-get-solution)
* [`pkg_deps$draw()`](#method-draw)
* [`pkg_deps$format()`](#method-format)
* [`pkg_deps$print()`](#method-print)

<a id="method-new"></a>

Method `pkg_deps$new()`
-------------------------------------

```r
pkg_deps$new(
  refs,
  config = list(),
  remote_types = NULL
)
```

Create a new `pkg_deps` object. Consider using `new_pkg_deps()` instead of
calling the constructor directly.

The returned object can be used to look up (recursive) dependencies of R
packages from various sources. To perform the actual lookup, you'll need
to call the [`resolve()`](#method-resolve) method.

### Parameters

* `refs`: Package names or references. See ['Package references'][pkg_refs]
  for the syntax.
* `config`: Configuration options, a named list. See
  ['Configuration'][pkg_config].
* `remote_types`: Custom remote ref types, this is for advanced use,
  and experimental currently.

### Returns

A new `pkg_deps` object.

### Examples

```{r}
pd <- pkg_deps$new("r-lib/pkgdepends")
pd
```

<hr>

<a id="method-get-refs"></a>

Method `pkg_deps$get_refs()`
-------------------------------------

```r
pkg_deps$get_refs()
```

The package refs that were used to create the `pkg_deps` object.

### Returns

A character vector of package refs that were used to create the `pkg_deps`
object.

### Examples

```{r}
pd <- new_pkg_deps(c("pak", "jsonlite"))
pd$get_refs()
```

<hr>

<a id="method-get-config"></a>

Method `pkg_deps$get_config()`
-------------------------------------

```r
pkg_deps$get_config()
```

Configuration options for the `pkg_deps` object. See
['Configuration'][pkg_config] for details.

### Returns

Named list. See ['Configuration'][pkg_config] for the configuration options.

### Examples

```{r}
pd <- new_pkg_deps("pak")
pd$get_config()
```

<hr>

<a id="method-resolve"></a>

Method `pkg_deps$resolve()`
-------------------------------------

```r
pkg_deps$resolve()
```

Resolve the dependencies of the specified package references. This usually
means downloading metadata from CRAN and Bioconductor, unless already
cached, and also from GitHub if GitHub refs were included, either directly
or indirectly. See ['Dependency resolution'][pkg_resolution] for details.

### Returns

The same as the [`get_resolution()`](#method-get-resolution) method
(see below), the result of the resolution, invisibly.

### Examples

```{r}
pd <- new_pkg_deps("pak")
pd$resolve()
pd
```

<hr>

<a id="method-async-resolve"></a>

Method `pkg_deps$async_resolve()`
-------------------------------------

```r
pkg_deps$async_resolve()
```

The same as [`resolve()`](#method-resolve), but asynchronous. This method
is for advanced use.

### Returns

A deferred value.

<hr>

<a id="method-get-resolution"></a>

Method `pkg_deps$get_resolution()`
-------------------------------------

```r
pkg_deps$get_resolution()
```

Query the result of the dependency resolution. This method can be
called after [`resolve()`](#method-resolve) has completed.

### Returns

A [pkg_resolution_result] object, which is also a tibble. See
[pkg_resolution_result] for its columns.

### Examples

```{r}
pd <- new_pkg_deps("r-lib/pkgdepends")
pd$resolve()
pd$get_resolution()
```

<hr>

<a id="method-solve"></a>

Method `pkg_deps$solve()`
-------------------------------------

```r
pkg_deps$solve()
```

Solve the package dependencies. Out of the resolved dependencies, it works
out a set of packages, that can be installed together to create a
functional installation. The set includes all directly specified packages,
and all required (or suggested, depending on the configuration) packages
as well. It includes every package at most once. See
['The dependency solver'][pkg_solution] for details.

`solve()` calls [`resolve()`](#method-resolve) automatically, if it
hasn't been called yet.

### Returns

The same as the [`get_solution()`](#method-get-solution) method, the
result, invisibly.

### Examples

```{r}
pd <- new_pkg_deps("r-lib/pkgdepends")
pd$resolve()
pd$solve()
pd
```

<hr>

<a id="method-get-solution"></a>

Method `pkg_deps$get_solution()`
-------------------------------------

```r
pkg_deps$get_solution()
```

Returns the solution of the package dependencies.

### Returns

A [pkg_solution_result] object, which is a list. See [pkg_solution_result]
for details.

### Examples

```{r}
pd <- new_pkg_deps("pkgload")
pd$resolve()
pd$solve()
pd$get_solution()
```

<hr>

<a id="method-draw"></a>

Method `pkg_deps$draw()`
-------------------------------------

```r
pkg_deps$draw()
```

Draw a tree of package dependencies. It returns a `tree` object, see
[cli::tree()]. Printing this object prints the dependency tree to the
screen.

### Returns

A `tree` object from the cli package, see [cli::tree()].

### Examples

```{r}
pd <- new_pkg_deps("pkgload")
pd$solve()
pd$draw()
```

<hr>

<a id="method-format"></a>

Method `pkg_deps$format()`
-------------------------------------

```r
pkg_deps$format(...)
```

Format a `pkg_deps` object, typically for printing.

### Parameters

* `...`: not used currently.

### Returns

A character vector, each element should be a line in the printout.

<hr>

<a id="method-print"></a>

Method `pkg_deps$print()`
-------------------------------------

```r
pkg_deps$print(...)
```

Prints a `pkg_deps` object to the screen. The printout includes:

* The package refs.
* Whether the object has the resolved dependencies.
* Whether the resolution had errors.
* Whether the object has the solved dependencies.
* Whether the solution had errors.
* Advice on which methods to call next.

See the example below.

### Parameters

* `...`: not used currently.

### Returns

The `pkg_deps` object itself, invisibly.

### Examples

```{r}
pd <- new_pkg_deps("r-lib/pkgdepends")
pd
```

```{r}
pd$resolve()
pd
```

```{r}
pd$solve()
pd
```

<hr>
