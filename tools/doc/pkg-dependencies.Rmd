
```{r include = FALSE}
options(
  pkg.show_progress = FALSE,
  cli.unicode = FALSE)
knitr::opts_chunk$set(cache = TRUE)
```

The usual steps to query package dependencies are:

1. Create a `\pkg_deps` object via `pkg_deps$new()`.
1. Resolve all possible dependencies via `pkg_deps$resolve()`.
1. Solve the dependencies, to obtain a subset of all possible
   dependencies that can be installed together, via `pkg_deps$solve()`.
1. Call `pkg_deps$get_solution()` to list the result of the
   dependency solver.

Methods
==========================================================================

```r
pkg_deps$new()
pkg_deps$get_refs()
pkg_deps$get_config()
pkg_deps$resolve()
pkg_deps$async_resolve()
pkg_deps$get_resolution()
pkg_deps$solve()
pkg_deps$get_solution()
pkg_deps$draw()
pkg_deps$format()
pkg_deps$print()
```

`new()`
-------------------------------------

```r
pkg_deps$initialize(
  refs,
  config = list(),
  remote_types = NULL)
```

Create a new `pkg_deps` object. The object can be used to look up
(recursive) dependencies of R packages from various sources.
To perform the actual lookup, you'll need to call the `

### Parameters

* `refs`: Package names or references. See [pkg_refs] for the syntax.
* `config`: Configuration options, a named list. See [pkg_config].
* `remote_types`: Custom remote ref types, this is for advanced use,
  and experimental currently.

### Returns

A new `pkg_deps` object.

### Examples

```{r}
pd <- pkg_deps$new("r-lib/pkgdepends")
pd
```

`get_refs()`
-------------------------------------

```r
pkg_deps$get_refs()
```

The package refs that were used to create the `pkg_deps` object.

### Returns

A character vector of package refs that were used to create the `pkg_deps`
object.

### Examples

```{r}
pd <- pkg_deps$new(c("pak", "jsonlite"))
pd$get_refs()
```

`get_config()`
-------------------------------------

```r
pkg_deps$get_config()
```

Configuration options for the `pkg_deps` object. See [pkg_config] for
details.

### Returns

Named list. See [pkg_config] for the configuration options.

### Examples

```{r}
pd <- pkg_deps$new("pak")
pd$get_config()
```

`resolve()`
-------------------------------------

```r
pkg_deps$resolve()
```

Resolve the dependencies of the specified package references. This usually
means downloading metadata from CRAN and Bioconductor, unless already
cached, and also from GitHub if GitHub refs were included, either directly
or indirectly. See [pkg_resolution] for details about dependency
resolution.

### Returns

The same as the `get_resolution()` method (see below), the result of the
resolution, invisibly.

### Examples

```{r}
pd <- pkg_deps$new("pak")
pd$resolve()
pd
```

`async_resolve()`
-------------------------------------

```r
pkg_deps$async_resolve()
```

The same as `resolve()`, but asynchronous. This method is for advanced
use.

### Returns

A deferred value.

`get_resolution()`
-------------------------------------

```r
pkg_deps$get_resolution()
```

Query the result of the dependency resolution. This method can be
called after `resolve()` has completed.

### Returns

A [pkg_resolution_result] object, which is also a tibble. See
[pkg_resolution_result] for its columns.

### Examples

```{r}
pd <- pkg_deps$new("r-lib/pkgdepends")
pd$resolve()
pd$get_resolution()
```

`solve()`
-------------------------------------

```r
pkg_deps$solve()
```

Solve the package dependencies. Out of the resolved dependencies, it works
out a set of packages, that includes all directly specified packages,
and all required (or suggested, depending on the configuration) packages
as well. It includes every package at most once. See [pkg_solution] for
details.

`solve()` calls `resolve()` automatically, if it hasn't been called yet.

### Returns

The same as the `get_solution()` method, the result, invisibly.

### Examples

```{r}
pd <- pkg_deps$new("r-lib/pkgdepends")
pd$resolve()
pd$solve()
pd
```

`get_solution()`
-------------------------------------

```r
pkg_deps$get_solution()
```

Returns the solution of the package dependencies.

### Returns

A [pkg_solution_result] object, which is a list. See [pkg_solution_result]
for details.

### Examples

```{r}
pd <- pkg_deps$new("pkgload")
pd$resolve()
pd$solve()
pd$get_solution()
```

`draw()`
-------------------------------------

```r
pkg_deps$draw()
```

Draw a tree of package dependencies. It returns a `tree` object, see
[cli::tree()]. Printing this object prints the dependency tree to the
screen.

### Returns

A `tree` object from the cli package, see [cli::tree()].

### Examples

```{r}
pd <- pkg_deps$new("pkgload")
pd$solve()
pd$draw()
```

`format()`
-------------------------------------

```r
pkg_deps$format(...)
```

Format a `pkg_deps` object, typically for printing.

### Parameters

* `...`: not used currently.

### Returns

A character vector, each element should be a line in the printout.

`print()`
-------------------------------------

```r
pkg_deps$print(...)
```

Prints a `pkg_deps` object to the screen. The printout includes:

* The package refs.
* Whether the object has the resolved dependencies.
* Whether the resolution had errors.
* Whether the objevt has the solved dependencies.
* Whether the solution had errors.
* Advice on which methods to call next.

See the example below.

### Parameters

* `...`: not used currently.

### Returns

The `pkg_deps` object itself, invisibly.

### Examples

```{r}
pd <- pkg_deps$new("r-lib/pkgdepends")
pd
```

```{r}
pd$resolve()
pd
```

```{r}
pd$solve()
pd
```
